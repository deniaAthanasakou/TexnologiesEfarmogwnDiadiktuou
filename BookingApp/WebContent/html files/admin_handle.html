<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="../bootstrap/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="../bootstrap/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../jQuery/jquery-3.2.1.min.js"></script>
		<link href="../css files/register.css" rel="stylesheet" />
		<link href="../css files/user_page.css" rel="stylesheet" />
		<link href="../css files/welcome.css" rel="stylesheet" />
		<script type="text/javascript" src="../bower_components/bootstrap-datepicker/moment.min.js"></script>
		<script type="text/javascript" src="../bower_components/bootstrap-datepicker/jquery.min.js"></script>
		<script type="text/javascript" src="../bower_components/bootstrap-datepicker/bootstrap-datetimepicker.min.js"></script>
		<link rel="stylesheet" href="../bower_components/bootstrap-datepicker/bootstrap-datetimepicker.min.css" />
  		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  		
  		<script type="text/javascript" src="../dataTables/media/js/dataTables.bootstrap.min.js"></script>
		<script type="text/javascript" src="../dataTables/media/js/jquery.dataTables.min.js"></script>
		<link href="../dataTables/media/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
		
		
		
		<script language="JavaScript" type="text/javascript">
			function login(showhide){
				if(showhide == "show"){
					document.getElementById('popup').style.display="block";
				}
				else if(showhide == "hide"){
					document.getElementById('popup').style.display="none";
				}
			}
		
		</script>
		
		<script>
		$(document).ready(function(){
		    $('[data-toggle="popover"]').popover();   
		    $('#users').DataTable();
		});
		</script>
		
		<script>
		$(document).ready(function() {
			$('#users').on('click', '#button_approve', function(){
				
				var username = $(this).closest("tr").find('td:eq(1)').text();
				
				//alert(username);
				var xmlhttp;
				
	            if (window.XMLHttpRequest){  
	              xmlhttp=new XMLHttpRequest();
	            } else {
	              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	            }
	
	            var params = "?username=" + username;
	            xmlhttp.open("GET", "../SendDataPopulate" + params, false);	            
	            xmlhttp.send(null);

	            
	            var response = xmlhttp.responseText;
	            if(response=="1"){
	            	window.location.assign("approve_user.html");
	            }
	            
	            

			});
		});
		
		</script>
		
		<script>
            $(document).ready(function() { 
            	var xmlhttp;
	
	            if (window.XMLHttpRequest){  
	              xmlhttp=new XMLHttpRequest();
	            } else {
	              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	            }
	
	            xmlhttp.open("POST", "../AdminHandle", false);
	            xmlhttp.send();
	            var jsonResponse = JSON.parse(xmlhttp.responseText);
	            $('#users').DataTable().rows.add(jsonResponse).draw();
	            
	            
	        });
        </script>
        
        <script>
            $(document).ready(function() { 
            	var xmlhttp;
	
	            if (window.XMLHttpRequest){  
	              xmlhttp=new XMLHttpRequest();
	            } else {
	              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	            }
	           
	
	            xmlhttp.open("GET", "../CheckLoggedUser", false);
	            xmlhttp.send();
	            var response = xmlhttp.responseText;
	            if(response=="1"){
	            	document.getElementById("register_login").style.display="none"; 
	            	document.getElementById("user_logged").style.display="block";  
	            }
	            else{
	            	document.getElementById("user_logged").style.display="none"; 
	            	document.getElementById("register_login").style.display="block"; 
	            }
	            
	            
	            
	        });
        </script>
        
        <title>Admin Handle Users page</title>
		

	</head>
	<body>
	
		<div id ="wrapper">
	
			<div id = "header">
				<!-- register/login -->	
				<table class="headerTable">
					<tr>
			    		<td ><a href="../WelcomePage.html"><div id ="logo"></div></a></td>
			    		<td>
			    			<div id = "register_login">
			    				<a class="btn" href="javascript:login('show'); "><i class="glyphicon glyphicon-log-in"></i> Είσοδος ή Εγγραφή</a>
			    			</div>
			    			<div class="dropdown" id="user_logged" style="display:none">
								<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
									<i class="glyphicon glyphicon-home"></i> Συνδεδεμένος
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
									<li><a class="nav-item" href="./html files/user_page.html"><i class="glyphicon glyphicon-user"></i> Προφίλ</a></li>
									<li><a class="nav-item" href="../LogoutServlet"><i class="glyphicon glyphicon-log-out"></i> Έξοδος</a></li>
								</ul>
							</div>
			    		</td>
			  		</tr>
			 	</table>		
			</div>
			
			
			
		
			
			<div id= "mainContainer">
			
			
				<div class="container">
				
					<h1 id="accountTitle"><strong>Διαχείριση Χρηστών</strong></h1>
					
					<div id="navigation_bar">
						<ul class="nav nav-tabs">
						  <li class="nav-item"><a href="admin_page.html"><i class="glyphicon glyphicon-home"></i> Αρχική</a></li>
						  <li class="nav-item"><a href="change_profile_admin.html"><i class="glyphicon glyphicon-cog"></i> Διαχείριση Προφίλ</a></li>
						  <li class="nav-item dropdown">
							    <a class="nav-item dropdown-toggle" type="button" id="active" data-toggle="dropdown" style="cursor: pointer;"><i class="glyphicon glyphicon-pencil"></i> Διαχείριση Χρηστών <span class="badge">4</span><span class="caret"></span></a>
							    <ul class="dropdown-menu">
							    	<li><a class="nav-item" href="admin_handle.html"><i class="glyphicon glyphicon-list-alt"></i> Λίστα Χρηστών</a></li>
						        	<li><a class="nav-item" href="export_data.html"><i class="glyphicon glyphicon-download-alt"></i> Εξαγωγή Δεδομένων</a></li>
						        </ul>
							</li>
						  <li class="nav-item"><a href="#"><i class="glyphicon glyphicon-envelope"></i> Μηνύματα <span class="badge">4</span></a></li>
						  <li class="nav-item"><a href="#"><i class="glyphicon glyphicon-log-out"></i> Έξοδος</a></li>
						</ul>
					</div>
					
				
					<div  id="input-profile" class="container-fluid">
						<div class="sectionDiv">
							<div class="row" style="margin-bottom:20px;">
								<div class="col-md-12 text-center">
									<h3>Λίστα Χρηστών στο Σύστημα</h3>
								</div>
							</div>
							<div class="row">
							
								<table class="table table-responsive table-hover display" id="users" cellspacing="0" width="100%">
									<thead>
										<tr>
											<th>#</th>
											<th>Όνομα Χρήστη</th>
											<th>Όνομα</th>
											<th>Επώνυμο</th>
											<th>Ρόλοι</th>
											<th>Έγκριση</th>
										</tr>
									</thead>
									<tbody style="cursor:pointer" id="table_body">
										
									</tbody>
								</table>
							</div>
						</div>
					
					</div>
				</div>
			</div>
			
		
			<div id = "footer">
				<!-- footer -->
				<div class="links">	
					<a href="">Sitemap</a>
					<p style="margin-top:8px">Copyright &copy; 2017-2018 <a href="../WelcomePage.html">Book A Room</a></p>
				</div>
			</div>
		
		
		</div>
		
		
		<div id="popup" style="display:none;text-align:center">
			<form name="login" action="../LoginServlet" method="post">
				<center>Όνομα Χρήστη</center>
				<center><input class="form-control" placeholder="Εισαγωγή Ονόματος Χρήστη" name="username" size="45" maxlength="45" style="margin-top:10px;" required/></center>
				<center style="margin-top:10px;">Κωδικός Πρόσβασης</center>
				<center><input class="form-control" type="password" placeholder="Εισαγωγή Κωδικού Πρόσβασης" name="password" size="45" maxlength="45" style="margin-top:10px;" required/></center>
				<center><button class="btn btn-primary" type="submit" name="login" style="margin-top:10px;"/><i class="glyphicon glyphicon-log-in"></i> Είσοδος</center>
				<center style="margin-top:10px;"><a href="#">Ξέχασα τον κωδικό</a></center>
				<center style="margin-top:10px;"><a href="../html files/register.html" class="btn btn-info"><i class="glyphicon glyphicon-book"></i> Εγγραφή</a></center>
				<center><a class="btn btn-danger btn-sm" href="javascript:login('hide');" style="margin-top:50px;" ><i class="glyphicon glyphicon-remove"></i> Ακύρωση</a></center>
			</form>
		</div>
	
	</body>
</html>