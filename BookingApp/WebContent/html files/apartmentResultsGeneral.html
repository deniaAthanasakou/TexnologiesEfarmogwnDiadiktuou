<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="../bootstrap/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="../bootstrap/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../jQuery/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="../bower_components/jquery/jquery.min.js"></script>
		<script type="text/javascript" src="../bower_components/moment/min/moment.min.js"></script>
		<script type="text/javascript" src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
		<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css" />
		<link rel="stylesheet" href="../bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		
		
		
		<link href="../css files/welcome.css" rel="stylesheet" />
		<link href="../css files/apartmentsList.css" rel="stylesheet" />
		
		
		
		<script language="JavaScript" type="text/javascript">
			function login(showhide){
				if(showhide == "show"){
					document.getElementById('popup').style.display="block";
				}
				else if(showhide == "hide"){
					document.getElementById('popup').style.display="none";
				}
			}
		
		</script> 

		 <script>
			function checkValiditySearchPopup() {
				var inValid = new RegExp("[\\s]");		//whitespace
				var numbersSymbols = new RegExp("[^A-Za-z]");
				var onlyNumbers = new RegExp("[/^\d+$/]");
				
				var roomType = document.getElementById("roomType").value;
				var maxCost = document.getElementById("maxCost").value;
				var wifi = document.getElementById("wifi").value;
				var aircondition = document.getElementById("aircondition").value;
				var heating = document.getElementById("heating").value;
				var kitchen = document.getElementById("kitchen").value;
				var tv = document.getElementById("tv").value;
				var parking = document.getElementById("parking").value;
				var elevator = document.getElementById("elevator").value;
				
			   
			}
		</script>
		
		
		
		  <script>
            $(document).ready(function() { 
            	var xmlhttp;
	
	            if (window.XMLHttpRequest){  
	              xmlhttp=new XMLHttpRequest();
	            } else {
	              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	            }
	
	            xmlhttp.open("GET", "../CheckLoggedUser", false);
	            xmlhttp.send();
	            var response = xmlhttp.responseText;
	            if(response=="1"){
	            	document.getElementById("register_login").style.display="none"; 
	            	document.getElementById("user_logged").style.display="block";  
	            }
	            else{
	            	document.getElementById("user_logged").style.display="none"; 
	            	document.getElementById("register_login").style.display="block"; 
	            }
	            
	        });
        </script>
        
        
    
  
		<title>List of Apartments</title>
		
	</head>
	<body>
	
		<div id ="wrapper">
	
			<div id = "header">
			<!-- register/login -->	
				<table class="headerTable">
					<tr>
			    		<td ><a href="../WelcomePage.html"><div id ="logo"></div></a></td>
			    		<td>
			    			<div id = "register_login">
			    				<a class="btn" href="javascript:login('show'); "><i class="glyphicon glyphicon-log-in"></i> Είσοδος ή Εγγραφή</a>
			    			</div>
			    			<div class="dropdown" id="user_logged" style="display:none">
								<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
									<i class="glyphicon glyphicon-home"></i> Συνδεδεμένος
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
									<li><a class="nav-item" href="../ChooseUserServlet"><i class="glyphicon glyphicon-user"></i> Προφίλ</a></li>
									<li><a class="nav-item" href="../LogoutServlet"><i class="glyphicon glyphicon-log-out"></i> Έξοδος</a></li>
								</ul>
							</div>
			    		</td>
			  		</tr>
		  		</table>		
			
			</div>
		
		
			
			<div id= "mainContainer">
				<div class="container" id="cont">
					<div id="filters">
						<p><strong>Περισσότερα Φίλτρα Αναζήτησης</strong></p>
						<form method="post" onsubmit="return false">
													
							<div class="checkbox">
							  <label><input type="checkbox" id="wifi" name="wifi" value="wifi" >Ασύρματο Ίντερνετ</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="aircondition"  name="aircondition" value="aircondition" >Ψύξη</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="heating"  name="heating" value="heating" >Θέρμανση</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="kitchen"  name="kitchen" value="kitchen" >Κουζίνα</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="tv"  name="tv" value="tv" >Τηλεόραση</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="parking" name="parking"  value="parking" >Χώρος Στάθμευσης</label>
							</div>
							<div class="checkbox">
							  <label><input type="checkbox" id="elevator" name="elevator"  value="elevator" >Ανελκυστήρας</label>
							</div>
							<div class="form-group">
							  <label for="sel1">Τύπος Δωματίου</label>
							  <select class="form-control" id="roomType"  name="roomType" >
							  	<option>All (Private Room, Non Private Room, House)</option>
							    <option>Private Room</option>
							    <option>Non Private Room</option>
							    <option>House</option>
							    
							  </select>
							</div>
							<label>Μέγιστο Κόστος (σε €)</label>
							<div class="form-group">
							   <input class="form-control" type="number" value="0"  id="maxCost" name="maxCost" data-content="Δεν επιτρέπονται χαρακτήρες, σύμβολα ή κενά." data-toggle="popover"  data-trigger="focus" class="form-control"  required >
							</div>
							
							
							<div class="form-group" style="margin-top:30px; margin-left:10px;">
					        	<button class="btn btn-primary " name="submit" id="submit" type="button"><i class="glyphicon glyphicon-search"></i> Αναζήτηση</button>
					      	</div>
				      	</form>
			      	</div>
			      	
			      	<div id="results">
						<h1 style="text-align:center">Αποτελέσματα αναζήτησης</h1> 
						
								
						
						<div class="container-fluid" id="ContainerList">
							<script language="JavaScript" type="text/javascript">
							
						 	var xmlhttp;
			            	
				            if (window.XMLHttpRequest){  
				              xmlhttp=new XMLHttpRequest();
				            } else {
				              xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
				            }
				            
				            xmlhttp.open("POST", "../GetAptsFromWelcomeSearch", false);
				            xmlhttp.send();
				            
				            document.getElementById('submit').onclick=function()
				            {
				            	//parameters
				            	var roomType = document.getElementById("roomType").value;
								var maxCost = document.getElementById("maxCost").value;
								var wifi = document.getElementById("wifi").checked;
								var aircondition = document.getElementById("aircondition").checked;
								var heating = document.getElementById("heating").checked;
								var kitchen = document.getElementById("kitchen").checked;
								var tv = document.getElementById("tv").checked;
								var parking = document.getElementById("parking").checked;
								var elevator = document.getElementById("elevator").checked;
								var params = "?roomType=" + roomType
										+ "&maxCost=" + maxCost
										+ "&wifi=" + wifi
										+ "&aircondition=" + aircondition
										+ "&kitchen=" + kitchen
										+ "&heating=" + heating
										+ "&tv=" + tv
										+ "&parking=" + parking
										+ "&elevator=" + elevator;		
								
				            	
				            	
				            	xmlhttp.open("GET", "../GetAptsFromWelcomeFilterSearch" + params, false);
				            	xmlhttp.send(null);
				            	var jsonResponse = JSON.parse(xmlhttp.responseText);
					            
					           
					            var jsonLength = jsonResponse.apts.length;

								var container = document.getElementById('ContainerList');
								container.innerHTML = '';

					            var htmlCode = "<div class=\"row apartment\" style=\"margin-bottom:10%;\">"+
							       "<div class=\"col-sm-3\" style=\"vertical-align:middle;height:100%;\">"+
							       "	<img class=\"img-responsive photo_apt\" width=\"200\" height=\"100%\" style=\"vertical-align:middle;\">"+
							       "</div>"+
							       " <textarea rows=\"1\" class=\"room_id\" name=\"room_id\" style=\"display:none\"></textarea>"+
							       "  <div class=\"col-sm-9\">"+
							       "     <table class=\"table table-hover\">"+
							       "         <tr>"+
							       "          <td>Κόστος ενοικίασης ανά ημέρα</td>"+
							       "          <td class=\"costPerDay\"></td>"+
							       "        </tr>"+
							       "         <tr>"+
							       "           <td>Τύπος Ενοικιαζόμενου Χώρου</td>"+
							       "           <td class=\"roomType\"></td>"+
							       "         </tr>"+
							       "         <tr>"+
							       "           <td>Αριθμός Κρεβατιών</td>"+
							       "           <td class=\"beds\"></td>"+
							       "         </tr>"+
							       "         <tr>"+
							       "           <td>Αριθμός Κριτικών</td>"+
							       "           <td class=\"noOfCritics\"></td>"+
							       "         </tr>"+
							       "         <tr>"+
							       "           <td>Κριτική (0-5)</td>"+
							       "           <td class=\"avgCritic\"></td>"+
							       "         </tr>"+
							       "		</table>   "+
							       " 		<div class=\"text-right\"> <a href =\"apartmentWithDetails.html\"> Περισσότερα</a> </div>	"	+
							       "  </div>"+
							       "</div> ";
							       
							       
							    var i=0;
				         	
					            for (i = 0; i < jsonLength; i++) {
					            	container.innerHTML+=htmlCode;
					            } 
					            
					            var costs = document.getElementsByClassName("costPerDay");
					            var types = document.getElementsByClassName("roomType");
					            var beds = document.getElementsByClassName("beds");
					            var noOfCitics = document.getElementsByClassName("noOfCritics");
					            var avgCritic = document.getElementsByClassName("avgCritic");
					            var Ids = document.getElementsByClassName("room_id");
					           
					           
					            for (i = 0; i < jsonLength; i++) {
					            	
					            	costs[i].innerHTML = jsonResponse.apts[i].costPerDay;
					            	types[i].innerHTML = jsonResponse.apts[i].type;
					            	beds[i].innerHTML = jsonResponse.apts[i].beds;
					            	noOfCitics[i].innerHTML = jsonResponse.apts[i].critics;
					            	avgCritic[i].innerHTML = jsonResponse.apts[i].avgCritic;
					            	Ids[i].innerHTML = jsonResponse.apts[i].room_id;
					            	//images[i].src = jsonResponse.apts[i].image;	
					            	
					            }  
								return;
				            }
				           
				            
				            
				            var jsonResponse = JSON.parse(xmlhttp.responseText);
				            
				            var costs = document.getElementsByClassName("costPerDay");
				            var types = document.getElementsByClassName("roomType");
				            var beds = document.getElementsByClassName("beds");
				            var noOfCitics = document.getElementsByClassName("noOfCritics");
				            var avgCritic = document.getElementsByClassName("avgCritic");
				            var Ids = document.getElementsByClassName("room_id");
				            //var images = document.getElementsByClassName("photo_apt");
				            
				            
				            
				            var jsonLength = jsonResponse.apts.length;

							var container = document.getElementById('ContainerList');

				            var htmlCode = "<form action=\"../SendRoomIdToAptDetails\" method=\"get\">" +
				            	"<div class=\"row apartment\" style=\"margin-bottom:10%;\">"+
						       "<div class=\"col-sm-3\" style=\"vertical-align:middle;height:100%;\">"+
						       "	<img class=\"img-responsive photo_apt\" width=\"200\" height=\"100%\" style=\"vertical-align:middle;\">"+
						       "</div>"+
						       " <textarea rows=\"1\" class=\"room_id\" name=\"room_id\" style=\"display:none\"></textarea>"+
						       "  <div class=\"col-sm-9\">"+
						       "     <table class=\"table table-hover\">"+
						       "         <tr>"+
						       "          <td>Κόστος ενοικίασης ανά ημέρα</td>"+
						       "          <td class=\"costPerDay\"></td>"+
						       "        </tr>"+
						       "         <tr>"+
						       "           <td>Τύπος Ενοικιαζόμενου Χώρου</td>"+
						       "           <td class=\"roomType\"></td>"+
						       "         </tr>"+
						       "         <tr>"+
						       "           <td>Αριθμός Κρεβατιών</td>"+
						       "           <td class=\"beds\"></td>"+
						       "         </tr>"+
						       "         <tr>"+
						       "           <td>Αριθμός Κριτικών</td>"+
						       "           <td class=\"noOfCritics\"></td>"+
						       "         </tr>"+
						       "         <tr>"+
						       "           <td>Κριτική</td>"+
						       "           <td class=\"avgCritic\"></td>"+
						       "         </tr>"+
						       "		</table>   "+
						       " 		<div class=\"text-right\"> <button type=\"submit\"> Περισσότερα</button> </div>	"	+
						       "  </div>"+
						       "</div> "+
						       "</form>";
						       
						       
						    var i=0;
			         	
				            for (i = 0; i < jsonLength; i++) {
				            	container.innerHTML+=htmlCode;
				            } 
				            
				           
				           
				            for (i = 0; i < jsonLength; i++) {
				            	
				            	costs[i].innerHTML = jsonResponse.apts[i].costPerDay;
				            	types[i].innerHTML = jsonResponse.apts[i].type;
				            	beds[i].innerHTML = jsonResponse.apts[i].beds;
				            	noOfCitics[i].innerHTML = jsonResponse.apts[i].critics;
				            	avgCritic[i].innerHTML = jsonResponse.apts[i].avgCritic;
				            	Ids[i].innerHTML = jsonResponse.apts[i].room_id;
				            	//images[i].src = jsonResponse.apts[i].image;	
				            	
				            }  
							
							
							</script>
							 	
						</div>  
						
						
					</div>
				</div>

			</div>
			
		
		
			<div id = "footer">
				<!-- footer -->
				<div class="links">	
					<a href="">Sitemap</a>
					<p style="margin-top:8px">Copyright &copy; 2017-2018 <a href="../WelcomePage.html">Book A Room</a></p>
				</div>
			</div>	
		
		</div>


		<div id="popup" style="display:none;text-align:center">
			<form name="login" action="../LoginServlet" method="post">
				<center>Όνομα Χρήστη</center>
				<center><input class="form-control" placeholder="Εισαγωγή Ονόματος Χρήστη" name="username" size="45" maxlength="45" style="margin-top:10px;" required/></center>
				<center style="margin-top:10px;">Κωδικός Πρόσβασης</center>
				<center><input class="form-control" type="password" placeholder="Εισαγωγή Κωδικού Πρόσβασης" name="password" size="45" maxlength="45" style="margin-top:10px;" required/></center>
				<center><button class="btn btn-primary" type="submit" name="login" style="margin-top:10px;"/><i class="glyphicon glyphicon-log-in"></i> Είσοδος</center>
				<center style="margin-top:10px;"><a href="#">Ξέχασα τον κωδικό</a></center>
				<center style="margin-top:10px;"><a href="register.html" class="btn btn-info"><i class="glyphicon glyphicon-book"></i> Εγγραφή</a></center>
				<center><a class="btn btn-danger btn-sm" href="javascript:login('hide');" style="margin-top:50px;" ><i class="glyphicon glyphicon-remove"></i> Ακύρωση</a></center>
			</form>
		</div>
	
	</body>
</html>